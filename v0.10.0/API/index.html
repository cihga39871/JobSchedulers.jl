<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · JobSchedulers.jl</title><meta name="title" content="API · JobSchedulers.jl"/><meta property="og:title" content="API · JobSchedulers.jl"/><meta property="twitter:title" content="API · JobSchedulers.jl"/><meta name="description" content="Documentation for JobSchedulers.jl."/><meta property="og:description" content="Documentation for JobSchedulers.jl."/><meta property="twitter:description" content="Documentation for JobSchedulers.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">JobSchedulers.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../manual/">Manual</a></li><li><a class="tocitem" href="../use_cases/">Use Cases</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Const/Variables"><span>Const/Variables</span></a></li><li><a class="tocitem" href="#Job"><span>Job</span></a></li><li><a class="tocitem" href="#Cron:-Job-Recur/Repeat"><span>Cron: Job Recur/Repeat</span></a></li><li><a class="tocitem" href="#Queue"><span>Queue</span></a></li><li><a class="tocitem" href="#Wait-For-Jobs"><span>Wait For Jobs</span></a></li><li><a class="tocitem" href="#Scheduler-Settings"><span>Scheduler Settings</span></a></li><li><a class="tocitem" href="#Scheduler-Control"><span>Scheduler Control</span></a></li><li><a class="tocitem" href="#Optimize-CPU-Usage"><span>Optimize CPU Usage</span></a></li><li><a class="tocitem" href="#Backup"><span>Backup</span></a></li><li><a class="tocitem" href="#Internal"><span>Internal</span></a></li></ul></li><li><a class="tocitem" href="../changelog/">Change Log</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cihga39871/JobSchedulers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cihga39871/JobSchedulers.jl/blob/main/docs/src/API.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Const/Variables"><a class="docs-heading-anchor" href="#Const/Variables">Const/Variables</a><a id="Const/Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Const/Variables" title="Permalink"></a></h2><pre><code class="language-julia hljs">const B = 1
const KB = 1024
const MB = 1024KB
const GB = 1024MB
const TB = 1024GB

const QUEUING = :queuing
const RUNNING = :running
const DONE = :done
const FAILED = :failed
const CANCELLED = :cancelled
const PAST = :past # super set of DONE, FAILED, CANCELLED

const cron_none = Cron(:none)

const SCHEDULER_TASK = Base.RefValue{Task}()
const SCHEDULER_REACTIVATION_TASK = Base.RefValue{Task}()</code></pre><h2 id="Job"><a class="docs-heading-anchor" href="#Job">Job</a><a id="Job-1"></a><a class="docs-heading-anchor-permalink" href="#Job" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.Job" href="#JobSchedulers.Job"><code>JobSchedulers.Job</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Job(command::Base.AbstractCmd; stdout=nothing, stderr=nothing, append::Bool=false, kwargs...)
Job(f::Function; kwargs...)
Job(task::Task; kwargs...)</code></pre><p><strong>Arguments</strong></p><ul><li><code>command::Base.AbstractCmd</code>: the command to run.</li><li><code>f::Function</code>: the function to run without any arguments, like <code>f()</code>.</li><li><code>task::Task</code>: the task to run. Eg: <code>@task(1+1)</code>.</li></ul><p><strong>Common Keyword Arguments (kwargs...)</strong></p><ul><li><code>name::String = &quot;&quot;</code>: job name.</li><li><code>user::String = &quot;&quot;</code>: user that job belongs to.</li><li><code>ncpu::Real = 1.0</code>: number of CPU this job is about to use (can be <code>Float64</code>, eg: <code>1.5</code> will use 150% CPU).</li><li><code>mem::Int64 = 0</code>: number of memory this job is about to use (supports TB, GB, MB, KB, B=1).</li><li><code>schedule_time::Union{DateTime,Period} = DateTime(0)</code>: The expected time to run.</li><li><code>dependency</code>: defer job until specified jobs reach specified state (QUEUING, RUNNING, DONE, FAILED, CANCELLED, PAST). PAST is the super set of DONE, FAILED, CANCELLED, which means the job will not run in the future. Eg: <code>DONE =&gt; job</code>, <code>[DONE =&gt; job1; PAST =&gt; job2]</code>.</li></ul><blockquote><p>The default state is DONE, so <code>DONE =&gt; job</code> can be simplified to <code>job</code>. To be compatible with old versions, you can also use job id (Int): <code>[DONE =&gt; job.id]</code>.</p></blockquote><ul><li><p><code>wall_time::Period = Year(1)</code>: wall clock time limit. Jobs will be terminated after running for this period.</p></li><li><p><code>priority::Int = 20</code>: lower means higher priority.</p></li><li><p><code>cron::Cron = Cron(:none)</code>: job recurring at specfic date and time. See more at <a href="#JobSchedulers.Cron"><code>Cron</code></a>.</p></li><li><p><code>until::Union{DateTime,Period} = DateTime(9999,1,1)</code>: stop job recurring <code>until</code> date and time.</p></li></ul><p><strong>Experimental Keyword Arguments - Output Redirection:</strong></p><ul><li><code>stdout=nothing</code>: redirect stdout to the file.</li><li><code>stderr=nothing</code>: redirect stderr to the file.</li><li><code>append::Bool=false</code>: append the stdout or stderr or not.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Redirecting in Julia are not thread safe, so unexpected redirection might be happen if you are running programs in different <code>Tasks</code> simultaneously (multi-threading).</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L15-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.submit!" href="#JobSchedulers.submit!"><code>JobSchedulers.submit!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">submit!(job::Job)</code></pre><p>Submit the job. If <code>job.submit_time == 0000-01-01T00:00:00 (default)</code>, it will change to the time of submission.</p><blockquote><p><code>submit!(Job(...))</code> can be simplified to <code>submit!(...)</code>. They are equivalent.</p></blockquote><p>See also <a href="#Job"><code>Job</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L85-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.cancel!" href="#JobSchedulers.cancel!"><code>JobSchedulers.cancel!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cancel!(job::Job)</code></pre><p>Cancel <code>job</code>, stop queuing or running.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L205-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.result" href="#JobSchedulers.result"><code>JobSchedulers.result</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">result(job::Job)</code></pre><p>Return the result of <code>job</code>. If the job is not done, a warning message will also show.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L301-L305">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.isqueuing" href="#JobSchedulers.isqueuing"><code>JobSchedulers.isqueuing</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isqueuing(j::Job) :: Bool</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L270-L272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.isrunning" href="#JobSchedulers.isrunning"><code>JobSchedulers.isrunning</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isrunning(j::Job) :: Bool</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L275-L277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.isdone" href="#JobSchedulers.isdone"><code>JobSchedulers.isdone</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isdone(j::Job) :: Bool</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L280-L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.iscancelled" href="#JobSchedulers.iscancelled"><code>JobSchedulers.iscancelled</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iscancelled(j::Job) :: Bool</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L285-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.isfailed" href="#JobSchedulers.isfailed"><code>JobSchedulers.isfailed</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isfailed(j::Job) :: Bool</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L290-L292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.ispast" href="#JobSchedulers.ispast"><code>JobSchedulers.ispast</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ispast(j::Job) :: Bool</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L295-L297">source</a></section></article><h2 id="Cron:-Job-Recur/Repeat"><a class="docs-heading-anchor" href="#Cron:-Job-Recur/Repeat">Cron: Job Recur/Repeat</a><a id="Cron:-Job-Recur/Repeat-1"></a><a class="docs-heading-anchor-permalink" href="#Cron:-Job-Recur/Repeat" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.Cron" href="#JobSchedulers.Cron"><code>JobSchedulers.Cron</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Cron(second, minute, hour, day_of_month, month, day_of_week)
Cron(;
    second = 0,
    minute = &#39;*&#39;,
    hour = &#39;*&#39;,
    day_of_month = &#39;*&#39;,
    month = &#39;*&#39;,
    day_of_week = &#39;*&#39;,
)</code></pre><p><code>Cron</code> stores the schedule of a repeative <code>Job</code>, inspired by Linux-based <code>crontab</code>(5) table.</p><p>Jobs are executed by JobScheduler when the second, minute, and hour fields match the current time, and when at least one of the two day fields (day of month &amp; month, or day of week) match the current time.</p><p><strong>When an argument is an <code>Int64</code>:</strong></p><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Allowed values</th></tr><tr><td style="text-align: right"><code>second</code></td><td style="text-align: right">0-59</td></tr><tr><td style="text-align: right"><code>minute</code></td><td style="text-align: right">0-59</td></tr><tr><td style="text-align: right"><code>hour</code></td><td style="text-align: right">0-23</td></tr><tr><td style="text-align: right"><code>day_of_month</code></td><td style="text-align: right">1-31</td></tr><tr><td style="text-align: right"><code>month</code></td><td style="text-align: right">1-12</td></tr><tr><td style="text-align: right"><code>day_of_week</code></td><td style="text-align: right">1-7 (1 is Monday)</td></tr></table><p><strong>When an argument is a <code>String</code> or <code>Char</code>:</strong></p><p>An argument may be an asterisk (<code>*</code>), which always stands for <span>$first-last$</span>.</p><p>Ranges of numbers are allowed. Ranges are two numbers separated with a hyphen. The specified range is inclusive. For example, 8-11 for an <span>$hours$</span> entry specifies execution at hours 8, 9, 10 and 11.</p><p>Lists are allowed. A list is a set of numbers (or ranges) separated by commas. Examples: <code>&quot;1,2,5,9&quot;</code>, <code>&quot;0-4,8-12&quot;</code>.</p><p>Step values can be used in conjunction with ranges. Following a range with <code>/&lt;number&gt;</code> specifies skips of the number&#39;s value through the range. For example, <code>&quot;0-23/2&quot;</code> can be used in the <code>hour</code> argument to specify Job execution every other hour (the alternative is <code>&quot;0,2,4,6,8,10,12,14,16,18,20,22&quot;</code>). Steps are also permitted after an asterisk, so if you want to say <span>$every two hours$</span>, just use <code>&quot;*/2&quot;</code>.</p><p><strong>When an argument is a <code>Vector</code>:</strong></p><p><code>Vector</code> works like lists mentioned above. For example, <code>[1,2,5,9]</code> is equivalent to <code>&quot;1,2,5,9&quot;</code>.</p><p><strong>When an argument is a <code>UInt64</code>:</strong></p><p><code>UInt64</code> is the internal type of <code>Cron</code> fileds. All the previous types will be converted to a <code>UInt64</code> bit array. The start index of the bit array is 0. Bits outside of the allowed values (see the table above) are ignored.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/job_recur.jl#L21-L64">source</a></section><section><div><pre><code class="language-julia hljs">Cron(special::Symbol)</code></pre><p>Instead of the six arguments of <code>Cron</code>, one of the following special symbols may appear instead:</p><table><tr><th style="text-align: right"><code>special</code></th><th style="text-align: right">Meaning</th></tr><tr><td style="text-align: right"><code>:yearly</code></td><td style="text-align: right">Run once a year, <code>Cron(0,0,0,1,1,0)</code></td></tr><tr><td style="text-align: right"><code>:annually</code></td><td style="text-align: right">(same as <code>:yearly</code>)</td></tr><tr><td style="text-align: right"><code>:monthly</code></td><td style="text-align: right">Run once a month, <code>Cron(0,0,0,1,&#39;*&#39;,&#39;*&#39;)</code></td></tr><tr><td style="text-align: right"><code>:weekly</code></td><td style="text-align: right">Run once a week, <code>Cron(0,0,0,&#39;*&#39;,&#39;*&#39;,1)</code></td></tr><tr><td style="text-align: right"><code>:daily</code></td><td style="text-align: right">Run once a day, <code>Cron(0,0,0,&#39;*&#39;,&#39;*&#39;,&#39;*&#39;)</code></td></tr><tr><td style="text-align: right"><code>:midnight</code></td><td style="text-align: right">(same as <code>:daily</code>)</td></tr><tr><td style="text-align: right"><code>:hourly</code></td><td style="text-align: right">Run once an hour, <code>Cron(0,0,&#39;*&#39;,&#39;*&#39;,&#39;*&#39;,&#39;*&#39;)</code></td></tr><tr><td style="text-align: right"><code>:none</code></td><td style="text-align: right">Never repeat, <code>Cron(0,0,0,0,0,0)</code></td></tr></table><p>Caution: Linux crontab&#39;s special <code>:reboot</code> is not supported here.</p><p>To run every minute, just use <code>Cron()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/job_recur.jl#L87-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.cron_value_parse" href="#JobSchedulers.cron_value_parse"><code>JobSchedulers.cron_value_parse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cron_value_parse(value::UInt64)
cron_value_parse(value::Int64)
cron_value_parse(value::String)
cron_value_parse(value::Char)
cron_value_parse(value::Vector)
cron_value_parse(*) = cron_value_parse(&#39;*&#39;)</code></pre><p>Parse crontab-like value to <code>UInt64</code>. See details: <a href="#JobSchedulers.Cron"><code>Cron</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/job_recur.jl#L137-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dates.tonext-Tuple{DateTime, Cron}" href="#Dates.tonext-Tuple{DateTime, Cron}"><code>Dates.tonext</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Dates.tonext(dt::DateTime, c::Cron) -&gt; Union{DateTime, Nothing}
Dates.tonext(t::Time, c::Cron; same::Bool = false) -&gt; Time
Dates.tonext(d::Date, c::Cron; same::Bool = false) -&gt; Union{DateTime, Nothing}</code></pre><p>Jobs are executed by JobScheduler when the second, minute, hour, and month of year fields match the current time, and when at least one of the two day fields (day of month, or day of week) match the current time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/job_recur.jl#L231-L237">source</a></section></article><h2 id="Queue"><a class="docs-heading-anchor" href="#Queue">Queue</a><a id="Queue-1"></a><a class="docs-heading-anchor-permalink" href="#Queue" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.queue" href="#JobSchedulers.queue"><code>JobSchedulers.queue</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">queue(; all::Bool = false)    -&gt; Vector{Job}
queue(state::Symbol )         -&gt; Vector{Job}
queue(needle)                 -&gt; Vector{Job}
queue(state::Symbol , needle) -&gt; Vector{Job}
queue(needle, state::Symbol ) -&gt; Vector{Job}
queue(id::Int)                -&gt; Job</code></pre><ul><li><p><code>all::Bool</code>: if true, get all jobs. if false, get only running and queuing jobs.</p></li><li><p><code>state::Symbol</code>: get jobs with a specific state, including <code>:all</code>, <code>QUEUING</code>, <code>RUNNING</code>, <code>DONE</code>, <code>FAILED</code>, <code>CANCELLED</code>, <code>PAST</code>.</p><blockquote><p><code>PAST</code> is the superset of <code>DONE</code>, <code>FAILED</code>, <code>CANCELLED</code>.</p></blockquote></li><li><p><code>needle::Union{AbstractString,AbstractPattern,AbstractChar}</code>: get jobs if they contain <code>needle</code> in their name or user.</p></li><li><p><code>id::Int</code>: get the job with the specific <code>id</code>.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/pretty_print.jl#L2-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.all_queue" href="#JobSchedulers.all_queue"><code>JobSchedulers.all_queue</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">all_queue()
all_queue(id::Int64)
all_queue(state::Symbol)
all_queue(needle::Union{AbstractString,AbstractPattern,AbstractChar})</code></pre><ul><li><p><code>state::Symbol</code>: get jobs with a specific state, including <code>:all</code>, <code>QUEUING</code>, <code>RUNNING</code>, <code>DONE</code>, <code>FAILED</code>, <code>CANCELLED</code>, <code>PAST</code>.</p><blockquote><p><code>PAST</code> is the superset of <code>DONE</code>, <code>FAILED</code>, <code>CANCELLED</code>.</p></blockquote></li><li><p><code>needle::Union{AbstractString,AbstractPattern,AbstractChar}</code>: get jobs if they contain <code>needle</code> in their name or user.</p></li><li><p><code>id::Int</code>: get the job with the specific <code>id</code>.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/pretty_print.jl#L128-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.job_query" href="#JobSchedulers.job_query"><code>JobSchedulers.job_query</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">job_query_by_id(id::Int64)</code></pre><p>Search job by <code>job.id</code> in the queue.</p><p>Return <code>job::Job</code> if found, <code>nothing</code> if not found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/query.jl#L1-L7">source</a></section></article><h2 id="Wait-For-Jobs"><a class="docs-heading-anchor" href="#Wait-For-Jobs">Wait For Jobs</a><a id="Wait-For-Jobs-1"></a><a class="docs-heading-anchor-permalink" href="#Wait-For-Jobs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.wait_queue" href="#JobSchedulers.wait_queue"><code>JobSchedulers.wait_queue</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wait_queue(;show_progress::Bool = false, exit_num_jobs::Int = 0)</code></pre><p>Wait for all jobs in <code>queue()</code> become finished.</p><ul><li><p><code>show_progress = true</code>, job progress will show.</p></li><li><p><code>exit_num_jobs::Int</code>: exit when <code>queue()</code> has less than <code>Int</code> number of jobs. It is useful to ignore some jobs that are always running or recurring.</p></li></ul><p>See also: <a href="#JobSchedulers.queue_progress"><code>queue_progress</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L263-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.wait-Tuple{Job}" href="#Base.wait-Tuple{Job}"><code>Base.wait</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wait(j::Job)
wait(js::Vector{Job})</code></pre><p>Wait for the job(s) to be finished.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L302-L307">source</a></section></article><h2 id="Scheduler-Settings"><a class="docs-heading-anchor" href="#Scheduler-Settings">Scheduler Settings</a><a id="Scheduler-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Scheduler-Settings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.set_scheduler" href="#JobSchedulers.set_scheduler"><code>JobSchedulers.set_scheduler</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_scheduler(;
    max_cpu::Union{Int,Float64} = JobSchedulers.SCHEDULER_MAX_CPU,
    max_mem::Union{Int,Float64} = JobSchedulers.SCHEDULER_MAX_MEM,
    max_job::Int = JobSchedulers.JOB_QUEUE.max_done,
    max_cancelled_job::Int = JobSchedulers.JOB_QUEUE.max_cancelled_job
)</code></pre><ul><li><code>max_job</code>: the number of jobs done. If number of jobs exceed 1.5*NUMBER, old jobs will be delete.</li><li><code>max_cancelled_job</code>: the number of cancelled jobs. If number of jobs exceed 1.5*NUMBER, old jobs will be delete.</li></ul><p>See details: <a href="#JobSchedulers.set_scheduler_max_cpu"><code>set_scheduler_max_cpu</code></a>,  <a href="#JobSchedulers.set_scheduler_max_mem"><code>set_scheduler_max_mem</code></a>,  <a href="#JobSchedulers.set_scheduler_max_job"><code>set_scheduler_max_job</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L232-L247">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.set_scheduler_max_cpu" href="#JobSchedulers.set_scheduler_max_cpu"><code>JobSchedulers.set_scheduler_max_cpu</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_scheduler_max_cpu(ncpu::Int = default_ncpu())
set_scheduler_max_cpu(percent::Float64)</code></pre><p>Set the maximum CPU (thread) the scheduler can use. If starting Julia with multi-threads, the maximum CPU is <code>nthreads() - 1</code>.</p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">set_scheduler_max_cpu()     # use all available CPUs
set_scheduler_max_cpu(4)    # use 4 CPUs
set_scheduler_max_cpu(0.5)  # use 50% of CPUs</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L147-L157">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.set_scheduler_max_mem" href="#JobSchedulers.set_scheduler_max_mem"><code>JobSchedulers.set_scheduler_max_mem</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_scheduler_max_mem(mem::Int = default_mem())
set_scheduler_max_mem(percent::Float64)</code></pre><p>Set the maximum RAM the scheduler can use.</p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">set_scheduler_max_mem()             # use 80% of total memory

set_scheduler_max_mem(4GB)          # use 4GB memory
set_scheduler_max_mem(4096MB)
set_scheduler_max_mem(4194304KB)
set_scheduler_max_mem(4294967296B)

set_scheduler_max_mem(0.5)          # use 50% of total memory</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L187-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.set_scheduler_max_job" href="#JobSchedulers.set_scheduler_max_job"><code>JobSchedulers.set_scheduler_max_job</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_scheduler_max_job(max_done::Int = 10000, max_cancelled::Int = max_done)</code></pre><p>Set the number of finished jobs. If number of jobs exceed 1.5*NUMBER, old jobs will be delete.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L218-L222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.destroy_unnamed_jobs_when_done" href="#JobSchedulers.destroy_unnamed_jobs_when_done"><code>JobSchedulers.destroy_unnamed_jobs_when_done</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JobSchedulers.destroy_unnamed_jobs_when_done(b::Bool)</code></pre><div class="admonition is-compat"><header class="admonition-header">New in v0.10</header><div class="admonition-body"><p>Before v0.10, all jobs will be saved to queue. However, from v0.10, unnamed jobs (<code>job.name == &quot;&quot;</code>) will not be saved if it <strong>successfully</strong> ran. If you want to save unnamed jobs, you can set using <code>JobSchedulers.destroy_unnamed_jobs_when_done(false)</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/JobQueue.jl#L53-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.set_group_seperator" href="#JobSchedulers.set_group_seperator"><code>JobSchedulers.set_group_seperator</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_group_seperator(group_seperator::Regex) = global GROUP_SEPERATOR = group_seperator</code></pre><p>Set the group seperator. Group seperator is used to group the names of Jobs. Used when display the progress meter using <code>wait_queue(show_progress=true)</code></p><p>Default is <code>r&quot;: *&quot;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_computing.jl#L25-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.GROUP_SEPERATOR" href="#JobSchedulers.GROUP_SEPERATOR"><code>JobSchedulers.GROUP_SEPERATOR</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GROUP_SEPERATOR::Regex = r&quot;: *&quot;</code></pre><p>Group seperator is used to group the names of Jobs. Used when display the progress meter using <code>wait_queue(show_progress=true)</code></p><p>To set it, use <code>set_group_seperator(group_seperator::Regex)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_computing.jl#L16-L22">source</a></section></article><h2 id="Scheduler-Control"><a class="docs-heading-anchor" href="#Scheduler-Control">Scheduler Control</a><a id="Scheduler-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Scheduler-Control" title="Permalink"></a></h2><p>Scheduler is automatically started, so it is not necessary to start/stop it.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.scheduler_status" href="#JobSchedulers.scheduler_status"><code>JobSchedulers.scheduler_status</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scheduler_status() :: Symbol</code></pre><p>Print the settings and status of job scheduler. Return <code>:not_running</code> or <code>:running</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.scheduler_start" href="#JobSchedulers.scheduler_start"><code>JobSchedulers.scheduler_start</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scheduler_start()</code></pre><p>Start the job scheduler.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L41-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.scheduler_stop" href="#JobSchedulers.scheduler_stop"><code>JobSchedulers.scheduler_stop</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scheduler_stop()</code></pre><p>Stop the job scheduler.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/control.jl#L79-L83">source</a></section></article><h2 id="Optimize-CPU-Usage"><a class="docs-heading-anchor" href="#Optimize-CPU-Usage">Optimize CPU Usage</a><a id="Optimize-CPU-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Optimize-CPU-Usage" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.solve_optimized_ncpu" href="#JobSchedulers.solve_optimized_ncpu"><code>JobSchedulers.solve_optimized_ncpu</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solve_optimized_ncpu(default::Int; 
    ncpu_range::UnitRange{Int64} = 1:total_cpu, 
    njob::Int = 1, 
    total_cpu::Int = JobSchedulers.SCHEDULER_MAX_CPU, 
    side_jobs_cpu::Int = 0)</code></pre><p>Find the optimized number of CPU for a job.</p><ul><li><code>default</code>: default ncpu of the job.</li><li><code>ncpu_range</code>: the possible ncpu range of the job.</li><li><code>njob</code>: number of the same job.</li><li><code>total_cpu</code>: the total CPU that can be used by JobSchedulers.</li><li><code>side_jobs_cpu</code>: some small jobs that might be run when the job is running, so the job won&#39;t use up all of the resources and stop small tasks.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L323-L337">source</a></section></article><h2 id="Backup"><a class="docs-heading-anchor" href="#Backup">Backup</a><a id="Backup-1"></a><a class="docs-heading-anchor-permalink" href="#Backup" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.set_scheduler_backup" href="#JobSchedulers.set_scheduler_backup"><code>JobSchedulers.set_scheduler_backup</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_scheduler_backup(
    filepath::AbstractString = &quot;&quot;;
    migrate::Bool = false,
    delete_old::Bool = false,
    recover_settings::Bool = true,
    recover_queue::Bool = true
)</code></pre><p>Set the backup file of job scheduler.</p><p>If <code>filepath</code> was set to <code>&quot;&quot;</code>, stop backup at exit.</p><p>If <code>filepath</code> was set to an existing file, <code>recover_settings</code> or <code>recover_queue</code> from <code>filepath</code> immediately.</p><p>If <code>filepath</code> was set to a new file, the backup file will be created at exit.</p><p>If <code>migrate=true</code> and the old <code>JobSchedulers.SCHEDULER_BACKUP_FILE</code> exists, the old backup file will be recovered before recovering from <code>filepath</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/backup.jl#L2-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.backup" href="#JobSchedulers.backup"><code>JobSchedulers.backup</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">backup()</code></pre><p>Manually backup job scheduler settings and queues. The function is automatically triggered at exit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/backup.jl#L66-L70">source</a></section></article><h2 id="Internal"><a class="docs-heading-anchor" href="#Internal">Internal</a><a id="Internal-1"></a><a class="docs-heading-anchor-permalink" href="#Internal" title="Permalink"></a></h2><h3 id="Internal-Scheduling"><a class="docs-heading-anchor" href="#Internal-Scheduling">Internal - Scheduling</a><a id="Internal-Scheduling-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-Scheduling" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.JobQueue" href="#JobSchedulers.JobQueue"><code>JobSchedulers.JobQueue</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JobQueue(; max_done::Int = 10000, max_cancelled::Int = 10000)
mutable struct JobQueue
    const queuing::SortedDict{Int,Vector{Job},Base.Order.ForwardOrdering}  # priority =&gt; Job List
    const queuing_0cpu::Vector{Job}              # ncpu = 0, can run immediately
    const future::Vector{Job}                    # all jobs with schedule_time &gt; now()
    const running::Vector{Job}
    const done::Vector{Job}
    const failed::Vector{Job}
    const cancelled::Vector{Job}
    max_done::Int
    max_cancelled::Int
    const lock_queuing::ReentrantLock
    const lock_running::ReentrantLock
    const lock_past::ReentrantLock
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/JobQueue.jl#L2-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.scheduler-Tuple{}" href="#JobSchedulers.scheduler-Tuple{}"><code>JobSchedulers.scheduler</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scheduler()</code></pre><p>The function of running Job&#39;s scheduler. It needs to be called by <code>scheduler_start()</code>, rather than calling directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L328-L332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.istaskfailed2" href="#JobSchedulers.istaskfailed2"><code>JobSchedulers.istaskfailed2</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">istaskfailed2(t::Task)</code></pre><p>Extend <code>Base.istaskfailed</code> to fit Pipelines and JobSchedulers packages, which will return a <code>StackTraceVector</code> in <code>t.result</code>, while Base considered it as <code>:done</code>. The function checks the situation and modifies the real task status and other properties.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L41-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.unsafe_run!" href="#JobSchedulers.unsafe_run!"><code>JobSchedulers.unsafe_run!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unsafe_run!(job::Job, current::DateTime=now()) :: Bool</code></pre><p>Jump the queue and run <code>job</code> immediately, no matter what other jobs are running or waiting. If successful initiating to run, return <code>true</code>, else <code>false</code>. </p><p>Caution: it will not trigger <code>scheduler_need_action()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L156-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.unsafe_cancel!" href="#JobSchedulers.unsafe_cancel!"><code>JobSchedulers.unsafe_cancel!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unsafe_cancel!(job::Job, current::DateTime=now())</code></pre><p>Caution: it is unsafe and should only be called within lock. Do not call from other module.</p><p>Caution: it will not trigger <code>scheduler_need_action()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L222-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.unsafe_update_state!" href="#JobSchedulers.unsafe_update_state!"><code>JobSchedulers.unsafe_update_state!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unsafe_update_state!(job::Job)</code></pre><p>Update the state of <code>job</code> from <code>job.task</code> when <code>job.state === :running</code>.</p><p>If a repeative job is PAST, submit a new job.</p><p>Caution: it is unsafe and should only be called within lock.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L376-L384">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.is_dependency_ok" href="#JobSchedulers.is_dependency_ok"><code>JobSchedulers.is_dependency_ok</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_dependency_ok(job::Job)::Bool</code></pre><p>Caution: run it within lock only.</p><p>Algorithm: Break for loop when found a dep not ok, and delete previous ok deps.</p><p>If dep is provided as Int, query Int for job and then replace Int with the job.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L401-L409">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.set_scheduler_while_loop" href="#JobSchedulers.set_scheduler_while_loop"><code>JobSchedulers.set_scheduler_while_loop</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_scheduler_while_loop(b::Bool)</code></pre><p>if set to false, the scheduler will stop.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.get_priority" href="#JobSchedulers.get_priority"><code>JobSchedulers.get_priority</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_priority(job::Job) = job.priority</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L318-L320">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.get_thread_id" href="#JobSchedulers.get_thread_id"><code>JobSchedulers.get_thread_id</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_thread_id(job::Job) = job._thread_id</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L313-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.date_based_on" href="#JobSchedulers.date_based_on"><code>JobSchedulers.date_based_on</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">date_based_on(c::Cron) -&gt; Symbol</code></pre><p>Whether date of <code>c</code> is based on <code>:dayofweek</code>, <code>:monthday</code>, <code>:everyday</code>, <code>:both</code>, or <code>:none</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/job_recur.jl#L419-L423">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.next_recur_job" href="#JobSchedulers.next_recur_job"><code>JobSchedulers.next_recur_job</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">next_recur_job(j::Job) -&gt; Union{Job, Nothing}</code></pre><p>Based on <code>j.cron</code> and <code>j.until</code>, return a new recurring <code>Job</code> or <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/jobs.jl#L364-L368">source</a></section></article><h3 id="Internal-Progress-Meter"><a class="docs-heading-anchor" href="#Internal-Progress-Meter">Internal - Progress Meter</a><a id="Internal-Progress-Meter-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-Progress-Meter" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To display a progress meter, please use <a href="#JobSchedulers.wait_queue"><code>wait_queue(show_progress = true)</code></a>.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.JobGroup" href="#JobSchedulers.JobGroup"><code>JobSchedulers.JobGroup</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct JobGroup
    name::String
    total::Int
    queuing::Int
    running::Int
    done::Int
    failed::Int
    cancelled::Int
end</code></pre><p><code>JobGroup</code> is computed when displaying a progress meter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_computing.jl#L37-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.get_group" href="#JobSchedulers.get_group"><code>JobSchedulers.get_group</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_group(job::Job, group_seperator = GROUP_SEPERATOR)
get_group(name::AbstractString, group_seperator = GROUP_SEPERATOR)</code></pre><p>Return <code>nested_group_names::Vector{String}</code>. </p><p>Eg: If <code>job.name</code> is <code>&quot;A: B: 1232&quot;</code>, return <code>[&quot;A&quot;, &quot;A: B&quot;, &quot;A: B: 1232&quot;]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_computing.jl#L164-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.progress_bar" href="#JobSchedulers.progress_bar"><code>JobSchedulers.progress_bar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">progress_bar(percent::Float64, width::Int = 20)</code></pre><p>Return ::String for progress bar whose char length is <code>width</code>.</p><ul><li><p><code>percent</code>: range from 0.0 - 1.0, or to be truncated.</p></li><li><p><code>width</code>: should be &gt; 3. If &lt;= 10, percentage will not show. If &gt; 10, percentage will show.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_view.jl#L7-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.queue_progress" href="#JobSchedulers.queue_progress"><code>JobSchedulers.queue_progress</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">queue_progress(;remove_tmp_files::Bool = true, kwargs...)
queue_progress(stdout_tmp::IO, stderr_tmp::IO;
group_seperator = GROUP_SEPERATOR, wait_second_for_new_jobs::Int = 1, loop::Bool = true, exit_num_jobs::Int = 0)</code></pre><ul><li><p><code>group_seperator</code>: delim to split <code>(job::Job).name</code> to group and specific job names.</p></li><li><p><code>wait_second_for_new_jobs::Int</code>: if <code>auto_exit</code>, and all jobs are PAST, not quiting <code>queue_progress</code> immediately but wait for a period. If new jobs are submitted, not quiting <code>queue_progress</code>.</p></li><li><p><code>loop::Bool</code>: if false, only show the current progress and exit. </p></li><li><p><code>exit_num_jobs::Int</code>: exit when <code>queue()</code> has less than <code>Int</code> number of jobs. It is useful to ignore some jobs that are always running or recurring.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_view.jl#L72-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.view_update" href="#JobSchedulers.view_update"><code>JobSchedulers.view_update</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">view_update(h, w; row = 1, groups_shown::Vector{JobGroup} = JobGroup[], is_in_terminal::Bool = true, is_interactive = true, group_seperator_at_begining = Regex(&quot;^&quot; * GROUP_SEPERATOR.pattern))</code></pre><p>Update the whole screen view.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_view.jl#L580-L584">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.PROGRESS_METER" href="#JobSchedulers.PROGRESS_METER"><code>JobSchedulers.PROGRESS_METER</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Bool. Showing progress meter? Related to progress computation and display</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/scheduler.jl#L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.update_group_state!" href="#JobSchedulers.update_group_state!"><code>JobSchedulers.update_group_state!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_group_state!(job::Job)</code></pre><p>This should only be called if <code>JobSchedulers.PROGRESS_METER == true</code>. Update the job&#39;s group state, which will be used in Progress Meter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_computing.jl#L69-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JobSchedulers.init_group_state!-Tuple{}" href="#JobSchedulers.init_group_state!-Tuple{}"><code>JobSchedulers.init_group_state!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_group_state!()</code></pre><p>Prepare group state for existing jobs </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cihga39871/JobSchedulers.jl/blob/f20136c158bd72209ec659adae93e6bd8f8ab5d6/src/progress_computing.jl#L121-L125">source</a></section></article><h3 id="Internal-Const/Variable"><a class="docs-heading-anchor" href="#Internal-Const/Variable">Internal - Const/Variable</a><a id="Internal-Const/Variable-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-Const/Variable" title="Permalink"></a></h3><pre><code class="language-julia hljs">const SCHEDULER_ACTION = Base.RefValue{Channel{Int}}()  # defined in __init__()
const SCHEDULER_ACTION_LOCK = ReentrantLock()
const SCHEDULER_PROGRESS_ACTION = Base.RefValue{Channel{Int}}()  # defined in __init__()

SCHEDULER_MAX_CPU::Int = nthreads() &gt; 1 ? nthreads()-1 : Sys.CPU_THREADS
SCHEDULER_MAX_MEM::Int = round(Int, Sys.total_memory() * 0.9)
const JOB_QUEUE = JobQueue(; max_done = JOB_QUEUE_MAX_LENGTH,  max_cancelled = max_done = JOB_QUEUE_MAX_LENGTH)

SCHEDULER_BACKUP_FILE::String = &quot;&quot;

SCHEDULER_WHILE_LOOP::Bool = true

SLEEP_HANDELED_TIME::Int = 10

DESTROY_UNNAMED_JOBS_WHEN_DONE::Bool = true

const ALL_JOB_GROUP = JobGroup(&quot;ALL JOBS&quot;)
const JOB_GROUPS = OrderedDict{String, JobGroup}()
const OTHER_JOB_GROUP = JobGroup(&quot;OTHERS&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../use_cases/">« Use Cases</a><a class="docs-footer-nextpage" href="../changelog/">Change Log »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 5 September 2024 18:32">Thursday 5 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
